<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="css/css.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@1,400;1,500;1,700&display=swap" rel="stylesheet">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Cardo&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://fonts.sandbox.google.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

	<title>HOSPITAL - B.G</title>
</head>
<body >
	
	<div class="cabecera">
		<img class="upperlogo" width="300" height="150" src="imagenes/nobg-logo.png">
		<div class="nav">
		<ul>
			<li class="menu"><a href="index2.html">MENU<span class="material-symbols-outlined">menu_open</span></a> </li>
		</ul>
		</div>
	</div>
	<div class="formularioPacientes">
		<h1 class="infoHospital">IMED Hospitales Online</h1>
		<form id="form" action="crearUsuario.php" method="post">
			<fieldset style="width: 200px;" >
			<legend><h1>Area Pacientes</h1></legend>
			<label>Nombre:</label> 
				<br>
				<input size="50" type="text" name="nombre" placeholder="Introduzca su nombre">	
				<br><br>
			<label>Apellidos:</label>
				<br>
				<input size="50" type="text" name="apellidos" placeholder="Introduzca sus dos apellidos">
				<br><br>
			<label>Telefono:</label>
				<br>
				<input size="50" type="tel" name="telefono" placeholder="Escriba su teléfono">
				<br><br>
			<label>Correo electrónico:</label>
				<br>
				<input size="50" type="email" name="correo" placeholder="Escriba su correo email">
				<br><br>

			<label>Usuario:</label>	
			<br>
			<input size="22" type="text" name="usuario" placeholder="Escriba su usuario" maxlength="10" required>
			<br>
			<label>	Contraseña:</label>
			<br>
			<input size="24" type="password" name="contra" placeholder="Escriba su contraseña" maxlength="10" required>
			
			<br><br><br>
			<input type="submit" value="Registrarse">

			</form>
		</fieldset>
	</div>
	
	<footer class="footer-distributed">

			<div class="footer-left">

				<h3>Company<span>logo</span></h3>

				<p class="footer-links">
					<a href="#" class="link-1">Home</a>
					
					<a href="#">Blog</a>
				
					<a href="#">Pricing</a>
				
					<a href="#">About</a>
					
					<a href="#">Faq</a>
					
					<a href="#">Contact</a>
				</p>

				<p class="footer-company-name">Company Name © 2015</p>
			</div>

			<div class="footer-center">

				<div>
					<i class="fa fa-map-marker"></i>
					<p><span>444 S. Cedros Ave</span> Solana Beach, California</p>
				</div>

				<div>
					<i class="fa fa-phone"></i>
					<p>+1.555.555.5555</p>
				</div>

				<div>
					<i class="fa fa-envelope"></i>
					<p><a href="mailto:support@company.com">support@company.com</a></p>
				</div>

			</div>

			<div class="footer-right">

				<p class="footer-company-about">
					<span>About the company</span>
					Lorem ipsum dolor sit amet, consectateur adispicing elit. Fusce euismod convallis velit, eu auctor lacus vehicula sit amet.
				</p>

				<div class="footer-icons">

					<a href="#"><i class="fa fa-facebook"></i></a>
					<a href="#"><i class="fa fa-twitter"></i></a>
					<a href="#"><i class="fa fa-linkedin"></i></a>
					<a href="#"><i class="fa fa-github"></i></a>

				</div>

			</div>

		</footer>
</body>
<script type="module">
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-app.js";

	 import { getFirestore} from "https://www.gstatic.com/firebasejs/9.7.0/firebase-firestore.js"
	 import { query, collection, getDocs, where } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-firestore.js";
	import { getAuth,signInWithEmailAndPassword,signOut  } from "https://www.gstatic.com/firebasejs/9.7.0/firebase-auth.js";
	
	// Your web app's Firebase configuration
	// For Firebase JS SDK v7.20.0 and later, measurementId is optional
	const firebaseConfig = {
	apiKey: "AIzaSyCp6Q_j8massOsIuXXWhlMp1yuig5ebmjE",
	authDomain: "hospital-5f67e.firebaseapp.com",
	projectId: "hospital-5f67e",
	storageBucket: "hospital-5f67e.appspot.com",
	messagingSenderId: "1004398381726",
	appId: "1:1004398381726:web:e7c0f93f111a0d93ae898f",
	measurementId: "G-KGZ9K8SRR2"
	};

	// Initialize Firebase
	 const app = initializeApp(firebaseConfig);
	 const db = getFirestore();
	 const auth = getAuth();
	
	const fors=document.getElementById('form');
	
	fors.addEventListener('submit', async (e) =>{
		 e.preventDefault()
	const usuario = fors['usuario'];
	const pass = fors['contra'];
	const q=query(collection(db,"Usuarios"),where("usuario","==", usuario.value))
	const querySnapshot= await getDocs(q);
	querySnapshot.forEach((doc) =>{
	const  dat  =doc.data();
	if(dat.usuario==usuario.value){
		
		if(dat.contra==pass.value){
			signInWithEmailAndPassword(auth,dat.correo,dat.contra)
			.then( (userCredential) => {
			// Signed in
				
				const user = userCredential.user;
			// ...
		//	window.location.href = "./index2.html";
			})
			.catch((error) => {
				const errorCode = error.code;
				const errorMessage = error.message;
			});
		}
		else{
			alert("Contraseña incorrecta")
		}

	}
	else{
		alert("El Usuario no existe")
	}
		
	});
	});
	const logOut=document.getElementById("logOut");
logOut.addEventListener('click',e=>{
e.preventDefault();
signOut(auth).then(() => {
alert("sesion cerrada")
});
});
</script>
</html>